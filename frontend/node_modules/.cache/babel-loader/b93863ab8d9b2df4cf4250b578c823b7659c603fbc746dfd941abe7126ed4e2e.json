{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Jismar/Desktop/Glitter/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Jismar/Desktop/Glitter/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Jismar/Desktop/Glitter/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/Jismar/Desktop/Glitter/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from\"axios\";import{useContext,useEffect,useReducer}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import Card from\"react-bootstrap/Card\";import Row from\"react-bootstrap/Row\";import Col from\"react-bootstrap/Col\";import ListGroup from\"react-bootstrap/ListGroup\";import Badge from\"react-bootstrap/Badge\";import Rating from\"../components/Rating\";import Button from\"react-bootstrap/esm/Button\";import{Helmet}from\"react-helmet-async\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{getError}from\"../utils\";import{Store}from\"../Store\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{product:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};function ProductScreen(){var navigate=useNavigate();var params=useParams();var slug=params.slug;var _useReducer=useReducer(reducer,{product:[],loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,product=_useReducer2$.product,dispatch=_useReducer2[1];// const [products, setProducts] = useState([]);\nuseEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_REQUEST'});_context.prev=1;_context.next=4;return axios.get(\"/api/products/slug/\".concat(slug));case 4:result=_context.sent;dispatch({type:'FETCH_SUCCESS',payload:result.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[slug]);var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cart=state.cart;var addToCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var existItem,quantity,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:existItem=cart.cartItems.find(function(x){return x._id===product._id;});quantity=existItem?existItem.quantity+1:1;_context2.next=4;return axios.get(\"/api/products/\".concat(product._id));case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context2.next=9;break;}window.alert('Sorry, Product is out of stock');return _context2.abrupt(\"return\");case 9:ctxDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});navigate('/cart');case 11:case\"end\":return _context2.stop();}},_callee2);}));return function addToCartHandler(){return _ref2.apply(this,arguments);};}();return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Description:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Price:\"}),/*#__PURE__*/_jsx(Col,{children:product.price})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{children:product.countInStock>0?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"In Stock\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Unavailable\"})})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,className:\"buttonClass\",children:\"Add to Cart\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["axios","useContext","useEffect","useReducer","useNavigate","useParams","Card","Row","Col","ListGroup","Badge","Rating","Button","Helmet","LoadingBox","MessageBox","getError","Store","reducer","state","action","type","loading","product","payload","error","ProductScreen","navigate","params","slug","dispatch","fetchData","get","result","data","ctxDispatch","cart","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","image","name","rating","numReviews","description","price"],"sources":["C:/Users/Jismar/Desktop/Glitter/frontend/src/screens/ProductScreen.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useReducer } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport ListGroup from \"react-bootstrap/ListGroup\";\r\nimport Badge from \"react-bootstrap/Badge\";\r\nimport Rating from \"../components/Rating\";\r\nimport Button from \"react-bootstrap/esm/Button\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nimport LoadingBox from \"../components/LoadingBox\";\r\nimport MessageBox from \"../components/MessageBox\";\r\nimport { getError } from \"../utils\";\r\nimport { Store } from \"../Store\";\r\n\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'FETCH_REQUEST':\r\n            return {...state, loading: true};\r\n        case 'FETCH_SUCCESS':\r\n            return {...state, product: action.payload, loading: false};\r\n        case 'FETCH_FAIL':\r\n            return {...state, loading: false, error: action.payload};\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nfunction ProductScreen() {\r\n    const navigate = useNavigate();\r\n    const params = useParams();\r\n    const {slug} = params;\r\n\r\n    const [{loading, error, product}, dispatch] = useReducer(reducer, {\r\n        product: [],\r\n        loading: true, \r\n        error: '',\r\n    });\r\n\r\n    // const [products, setProducts] = useState([]);\r\n\r\n    useEffect(function () {\r\n        const fetchData = async function () {\r\n            dispatch({type: 'FETCH_REQUEST'});\r\n            try {\r\n                const result = await axios.get(`/api/products/slug/${slug}`);\r\n                dispatch({type:'FETCH_SUCCESS', payload: result.data});\r\n            } catch (error) {\r\n                dispatch({ type: 'FETCH_FAIL', payload: getError(error) });\r\n            }\r\n        };\r\n            fetchData();\r\n    }, [slug]);\r\n\r\n    const {state, dispatch: ctxDispatch} = useContext(Store);\r\n    const { cart } = state;\r\n\r\n    const addToCartHandler = async() => {\r\n        const existItem = cart.cartItems.find((x) => x._id === product._id);\r\n        const quantity = existItem ? existItem.quantity + 1 : 1;\r\n        const { data } = await axios.get(`/api/products/${product._id}`);\r\n        if (data.countInStock < quantity) {\r\n            window.alert('Sorry, Product is out of stock');\r\n            return;\r\n        }\r\n\r\n        ctxDispatch({\r\n            type:'CART_ADD_ITEM',\r\n             payload: {...product, quantity},\r\n        });\r\n        navigate('/cart');\r\n    }\r\n\r\n    return (\r\n        loading ? ( \r\n            <LoadingBox ></LoadingBox>\r\n            ) : error ? ( \r\n            <MessageBox variant=\"danger\">{error}</MessageBox>\r\n        ) : \r\n        <div>\r\n            <Row>\r\n                <Col md={6}>\r\n                    <img className=\"img-large\" src={product.image} alt={product.name} />\r\n                </Col>\r\n                <Col md={3}>\r\n                    <ListGroup variant=\"flush\">\r\n                        <ListGroup.Item>\r\n                            <Helmet>\r\n                                <title>{product.name}</title>\r\n                            </Helmet>\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            <Rating rating={product.rating} numReviews={product.numReviews} />\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            Description:\r\n                            <p>{product.description}</p>\r\n                        </ListGroup.Item>\r\n                    </ListGroup>\r\n                </Col>\r\n                <Col md={3}>\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <ListGroup variant=\"flush\">\r\n                                <ListGroup.Item>\r\n                                    <Row>\r\n                                        <Col>Price:</Col>\r\n                                        <Col>{product.price}</Col>\r\n                                    </Row>\r\n                                </ListGroup.Item>\r\n                                <ListGroup.Item>\r\n                                    <Row>\r\n                                        <Col>Status:</Col>\r\n                                        <Col>{product.countInStock>0 ? <Badge bg=\"success\">In Stock</Badge> : <Badge bg=\"danger\">Unavailable</Badge>}</Col>\r\n                                    </Row>\r\n                                </ListGroup.Item>\r\n                                {product.countInStock > 0 && (\r\n                                <ListGroup.Item>\r\n                                    <div className=\"d-grid\">\r\n                                        <Button onClick={addToCartHandler} className=\"buttonClass\">\r\n                                            Add to Cart\r\n                                        </Button>\r\n                                    </div>\r\n                                </ListGroup.Item>\r\n                                )}\r\n                            </ListGroup>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    );\r\n    \r\n\r\n}\r\n\r\nexport default ProductScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}